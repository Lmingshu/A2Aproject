# A2A 相亲产品设计

## 1. 产品目标

解决**过年回家相亲面对面尴尬**的问题：让男女双方及双方家长通过 **AI 代理（Agent）先畅聊**，互相了解后再决定是否见面，降低冷场与尴尬。

## 2. 核心概念（基于 Towow）

- **投影 (Projection)**：每个参与者用「档案」投影出一个 Agent，代表自己发言。
- **轮次制 (Round)**：多轮对话，每轮 4 个 Agent 依次或并行发言，由 Center 协调。
- **回声 (Echo)**：对话结果可回流到档案（可选），用于后续匹配或复盘。

## 3. 参与方与 Agent 设计

| 角色 | Agent ID 示例 | 职责 | 人设要点 |
|------|----------------|------|----------|
| 男方 | `agent_male` | 代表男方本人 | 基于男方填写的档案：职业、爱好、家庭观、对另一半期望 |
| 女方 | `agent_female` | 代表女方本人 | 基于女方填写的档案：同上 |
| 男方家长 | `agent_male_parent` | 代表男方家庭 | 关心儿子婚事、家庭条件、对儿媳期望、可适度催婚但不强势 |
| 女方家长 | `agent_female_parent` | 代表女方家庭 | 关心女儿婚事、对女婿期望、重视人品与稳定 |

**档案字段（每方各自填写）**  
- 基础：昵称、年龄、职业、学历、所在地  
- 兴趣：爱好、日常、理想周末  
- 婚恋观：对婚姻/家庭的看法、对另一半的期望、是否接受与父母同住等  
- 家长专属：对子女对象的期望、家庭情况简述、是否着急等  

## 4. 流程设计

```
创建相亲会话（传入 4 方 Profile）
    ↓
【破冰轮】Center 给出开场话题 → 4 个 Agent 依次/并行发言（自我介绍或问候）
    ↓
【了解轮】Center 根据上文推进话题（兴趣、工作、家庭观等）→ 4 个 Agent 发言
    ↓
【深入轮】可多轮，Center 可点名某方回答或抛出新话题
    ↓
【总结轮】Center 综合对话输出：匹配度简述 + 建议（建议见面 / 可再聊 / 暂缓）
```

- **不依赖 HDC 共振**：参与方固定为 4，无需「需求广播→共振筛选」。
- **Center 职责**：决定每轮话题、汇总发言、控制轮数、输出最终总结。

## 5. 技术架构（底层基于 Towow）

- **引擎**：在 Towow 的「轮次制 + Center 协调」思路上，实现 **ConversationEngine**（或扩展现有 Engine）：固定 4 方、多轮对话、Center 只做协调与总结。
- **Skills**：
  - **DatingChatSkill**：按角色（男/女/男方家长/女方家长）+ 该方 Profile 生成当轮回复。
  - **DatingCenterSkill**：根据当前对话历史，决定下一轮话题/总结，并调用 `output_plan` 结束或继续。
- **适配器**：Profile 来源可为「表单填写」或后续对接 SecondMe（Towow 已有 SecondMe Adapter），统一成 Towow 的 ProfileDataSource 接口。
- **事件与前端**：沿用 Towow 的 WebSocket/事件推送，前端展示 4 方气泡流、Center 的总结。

## 6. 与 Towow 的对应关系

| Towow 概念 | A2A 相亲中的对应 |
|------------|------------------|
| Scene | 相亲场景（固定 4 方） |
| Agent | 男方 / 女方 / 男方家长 / 女方家长 |
| NegotiationSession | DatingSession（相亲会话） |
| Center | 主持人 / 协调者，推进话题并输出总结 |
| Offer | 每轮各 Agent 的「发言」 |
| output_plan | Center 输出最终匹配总结与建议 |

## 7. 扩展方向

- 接入 **SecondMe**：用 SecondMe 档案作为男女双方 Profile，家长仍用表单。
- **A2A 协议**：对外暴露 Agent Card + Task，便于其他 A2A 客户端发起「相亲畅聊」任务。
- 多轮后「真人接管」：某方可切换为真人输入，其余仍为 AI，由 Center 继续协调。
